{"ast":null,"code":"import React,{useEffect}from'react';import{useNavigate,useSearchParams}from'react-router-dom';import{toast}from'react-hot-toast';import{useAuth}from'../App';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DiscordCallbackPage=()=>{const navigate=useNavigate();const[searchParams]=useSearchParams();const{login}=useAuth();useEffect(()=>{const handleCallback=async()=>{const code=searchParams.get('code');const state=searchParams.get('state');const error=searchParams.get('error');const errorDescription=searchParams.get('error_description');if(error){console.error('Discord OAuth error:',error,errorDescription);toast.error(\"Erreur d'authentification: \".concat(errorDescription||error));navigate('/login');return;}if(!code){toast.error('Code d\\'autorisation manquant');navigate('/login');return;}try{console.log('Processing Discord OAuth callback with code:',code);const remember=localStorage.getItem('remember_me')==='true';await login(code,state,remember);toast.success('Connexion réussie !');navigate('/');}catch(error){var _error$response,_error$response$data;console.error('Login failed:',error);const message=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Échec de la connexion. Veuillez réessayer.';toast.error(message);navigate('/login');}finally{localStorage.removeItem('remember_me');}};handleCallback();},[searchParams,login,navigate]);return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-dark-950 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner w-16 h-16 mx-auto mb-6\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white mb-2\",children:\"Connexion en cours...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"V\\xE9rification avec Discord\"})]})});};export default DiscordCallbackPage;","map":{"version":3,"names":["React","useEffect","useNavigate","useSearchParams","toast","useAuth","jsx","_jsx","jsxs","_jsxs","DiscordCallbackPage","navigate","searchParams","login","handleCallback","code","get","state","error","errorDescription","console","concat","log","remember","localStorage","getItem","success","_error$response","_error$response$data","message","response","data","detail","removeItem","className","children"],"sources":["C:/Users/Knight-Server/Desktop/VerseLink-Xapollo/frontend/src/pages/DiscordCallbackPage.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { toast } from 'react-hot-toast';\nimport { useAuth } from '../App';\n\nconst DiscordCallbackPage = () => {\n  const navigate = useNavigate();\n  const [searchParams] = useSearchParams();\n  const { login } = useAuth();\n\n  useEffect(() => {\n    const handleCallback = async () => {\n      const code = searchParams.get('code');\n      const state = searchParams.get('state');\n      const error = searchParams.get('error');\n      const errorDescription = searchParams.get('error_description');\n\n      if (error) {\n        console.error('Discord OAuth error:', error, errorDescription);\n        toast.error(`Erreur d'authentification: ${errorDescription || error}`);\n        navigate('/login');\n        return;\n      }\n\n      if (!code) {\n        toast.error('Code d\\'autorisation manquant');\n        navigate('/login');\n        return;\n      }\n\n      try {\n        console.log('Processing Discord OAuth callback with code:', code);\n        const remember = localStorage.getItem('remember_me') === 'true';\n        await login(code, state, remember);\n        toast.success('Connexion réussie !');\n        navigate('/');\n      } catch (error) {\n        console.error('Login failed:', error);\n        const message = error.response?.data?.detail || 'Échec de la connexion. Veuillez réessayer.';\n        toast.error(message);\n        navigate('/login');\n      } finally {\n        localStorage.removeItem('remember_me');\n      }\n    };\n\n    handleCallback();\n  }, [searchParams, login, navigate]);\n\n  return (\n    <div className=\"min-h-screen bg-dark-950 flex items-center justify-center\">\n      <div className=\"text-center\">\n        <div className=\"loading-spinner w-16 h-16 mx-auto mb-6\"></div>\n        <h2 className=\"text-2xl font-bold text-white mb-2\">Connexion en cours...</h2>\n        <p className=\"text-gray-400\">Vérification avec Discord</p>\n      </div>\n    </div>\n  );\n};\n\nexport default DiscordCallbackPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}